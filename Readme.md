  # Initial Information
  This guide is primarily for me to be able to recall the information necessary to customize and optimize windows. Most of this is written from memory and may already be outdated. That said, feel free to use this information and code for whatever use case you will deem adequate, but be aware that stuff will break.
  # Windows Install
  What I should probably do in the future is to make a custom windows iso with all the components already debloated. Using an already existing one might be easier but who knows what the developer has put in it. For now the Windows 10 English (United States) iso is sufficient. \
  The easiest way to download it is from here (https://msdl.gravesoft.dev/#2618). If you don't trust this site, you can fiddle with the browser dev tools to change your browser agent on the official Microsoft download site, good luck. \
  Once the you have the iso, you need to create a bootable drive. A portable version of Rufus (https://rufus.ie/en/ should suffice). I can also recommend  Ventoys (https://www.ventoy.net/en/doc_compatible_mark.html) if you have a spare drive to use just for iso files. \
  Before installation, I recommend disconnecting the device completely from the internet, and to do not connect it during setup. \
  Rufus offers a few installation automation scripts, feel free to use them, but remember to uncheck the set region as current user one. This is important because ideally the region needs to be set to the English (World). This minimizes the initial app bloat, but ofc breaks some location related stuff like the Microsoft store. \
  Set the remaining options according to your preference.
  # Network lockdown and updates
  When Windows boots into the desktop, restart it to get rid of residual processes. Then you should transfer the debloating programs to the system from the (Install) folder, mainly the Simplewall portable firewall (https://github.com/henrypp/simplewall). What I would do is to use a (add user folder to navigation pane.reg) regedit script, just for convenience. Then in the user folder I would make two folders, the (_MyPrograms) folder and the (_My) folder. This is where I generally store all my data. \
  Plop the Simplewall software into the Programs folder, run it, and set it to auto run on startup. If you are doing this for the first time some other settings might also need to be configured, to for example allow the Windows updates. \
  This is the moment when you can connect the machine to the internet. You will get a bunch of popups from different windows processes trying to access the web. Block them all. \
  If it has not started already, run the Windows update and wait for it to download and install all the updatess. If the updates are locked behind the firewall, check the simplewall settings. As a last resort disable the firewall to download the updates.
  # Initial app and service debloat
  This will cover the scripts for the less intrusive debloat. I usually use the One tool for everything script (irm christitus.com/win | iex). When you run it, remember to allow the PowerShell through the firewall via the popup. The most important scripts are to disable services, uninstall Microsoft apps, OOshutup to disable telemetry, some theming options on the side, and to disable windows feature updates setting. Those options will not remove everything, but it is a good base to then refine. \
  After a quick restart we can continue with uninstalling the applications. The previous script does not touch apps like the photo app or the microsoft store. You can uninstall those with the BCUninstaller (https://github.com/Klocman/Bulk-Crap-Uninstaller). Install as portable, put in the programs' folder, read the tutorial, then change a few settings to be able to see the Microsoft programs and select them via checkboxes. I prefer to remove everything since all Microsoft apps are essentially spyware. \
  Regarding Microsoft Edge, there is one thing that needs to be checked to prevent it from reinstalling itself. Check the path: (C:\Program Files (x86)\Microsoft), and delete everything that is in there. The update service files are probably locked, so you will need to force delete them with a tool like the Iobit unlocker, or with a script. Another method would be to enable the European options with a tool like WinToys, and then safely uninstall manually. \
  At this point it is probably also reasonable to take a look at the services.msc and disable anything unnecessary there, like for example the Data Usage service, Windows search indexer (If you don't plan to use the start menu), or any device specific services (bloat from the manufacturers). \
  Also look through the windows settings app and change stuff to your liking.
  Some stuff on the top of my head are the Repeat delay, cursor blink, disabling the keyboard layout change shortcuts, power options, disabling windows sound. Another thing is to change the windows 'Performance Options', disable everything besides the show thumbnails instead of icons, show window contents while dragging and smooth edges of screen fonts. Also disable animations and transparency in settings.
  # Windows Component debloat
  At this point most of the windows' ui elements still work. If you are satisfied or this is not your machine you should probably just leave it like that and go to the Theming section. I however, absolutely despise the Microsoft start menu and the taskbar, so naturally I am going to remove them and replace them with something better. \
  Starting with the start menu, install the flow launcher (https://www.flowlauncher.com), preferably as portable. I'm sticking to the version 1.16.2, because for some reason they thought it would be a good idea to be able to resize the search window directly, and by doing so block the scrollbar. Also that update broke my theme. Thanks. But you do you, use what you want, maybe a different tool will suit you better, there are plenty of alternations. \
  The newer versions supposedly support the Windows key keybind natively, but I am still stuck with an autohotkey script (_Scripts/_Functional/Startup). The script needs to be put in a windows start menu startup folder(AppData\Roaming\Microsoft\Windows\Start Menu\Programs). You will also need to rebind the trigger key to F23 in the flow launcher settings. \
  Next, once the launcher is all good and running you can proceed to rip out the start menu components. They are located in (C:\Windows\SystemApps), and look like Microsoft.Windows.Search_xxx, MicrosoftWindows.Client.CBS_xxx, Microsoft.Windows.StartMenuExperienceHost_xxx. They run constantly in the background and since you won't be using the start menu you don't need those processes. That said, be careful when deleting system files, there are other components in that folder that can be deleted without much issue, just read the name carefully and decide. If you are not sure if you want them gone or not, just move them to the desktop to see the effects. Worst case scenario you can move them back. They are device specific, so I guess you might as well just keep them in a folder somewhere. I recommend checking the task manager and look at the processes, if you see one hogging ram that comes from this folder, you know what to do. \
  Another folder to have a look through is the (C:\Program Files\WindowsApps), there might be some residue there. \
  As for the taskbar, since it is a part of the explorer.exe process, the mod is less intrusive. You have to enable the automatic hiding of taskbar in the settings, and then install the Nircmd (https://www.nirsoft.net/utils/nircmd.html) utility and use it with a startup script (TaskbarHide). While this method is not ideal, it is the best I have found so far, I am welcome to recommendations to permanently hide the taskbar.\
  That takes care of the worst windows ui components, you don't really need the taskbar since Alt+tab exists. You can find a theme for the flow launcher in one of my other repositories. As for the plugins, they can be used to search files, for clipboard history, killing processes, shutting down your computer, and many more. If anything happens you can use Win+L to log out and restart your pc.
  # Making file explorer 'usable'
  I have already added a user folder to the navigation pane of the explorer, but this is nowhere near to make it feel like home. First go into the user folder, you should see in it a bunch of random libraries, and your Programs folder. Delete all the libraries besides the Desktop and the Documents. They won't really disappear until a refresh, and they will get re-added after some time. I have not found a way to completely delete them yet. If the downloads' library gets deleted, it will be moved to the documents' folder. \
  There are limits to what can be done manually through the settings, but those are still improvements. Go to view, select the Details view, then enable the checkboxes to select items, item extensions and hidden items. In sort by go to choose types and only leave the name and total size enabled. \
  Now we can move to the explorer settings. Set file explorer to open in This PC, enable single click to open an item (Why the hell would you double-click everything, you can just use checkboxes or control to select). Disable anything related to the Quick access. Last two things are to go to the View panel (In the options' menu, not the previous one), and disable the status bar, if you want to free up some space. The second one is to enable the Display full path in the title bar. \
  Continuing the removal of useless menus, the whole options ribbon can be removed, (minimized). The process is a bit complicated so I recommend following a guide (https://old.reddit.com/r/windows/comments/gh7xo2/how_to_remove_ribbon_and_command_bar_from_file/). All the relevant files are in the (Install\ExplorerTweaks\RemoveRibbon), including the already modified .dll. After the tweak you can still access the options by pressing Alt. \
  Now, additional you can run the (Remove_Quick_access_from_navigation_pane.reg), to get rid of quick access. Want to keep your files organized? Then don't be lazy and don't use quick access. \
  Additionally, it is a good idea to add the _MyPrograms folder and the _My folder that are located in the user folder to the navigation pane. This can be done via a tool like Winaero tweaks, mentioned below (Navigation pane - Custom items). The (Navigation pane - Default items) allows the removal of some additional bloat like the duplicated drives and the network icon. Also customize things under 'This PC folders' to only have the Desktop, Documents and drives.
  # Windows visual options.
  Windows by default adds a lot of unnecessary padding around the (window borders) and (title bars). The (scrollbars) are also a bit too big. The size of all of those can be reduced easily with Winaero tweaker (https://winaerotweaker.com) under the tab of (advanced apperance settings). Just input the minimal value, do not freak out when stuff looks out of place, and log out. It will look much better. \
  Other tweaks worth mentioning are the 'Alt+Tab Appearance', to remove the transparency, Disable windows smart screen, Keep thumbnail cache, Drive letters - to move them to the left, Enable classic search, Enable recycle bin for removable drives (This one is a lifesaver), and the Shortcut customizations to disable the suffix and to change the icon to a more old school one. \
  Winearo also has a lot of other options, you should scan through them and adjust them to your liking. My simplest config can be found in the (winaerotweaker)
  # The abomination that is the context menu
  The Windows context menu, because of it's bloat, leaves a lot to be desired. The sad thing is that it can only be modified by changing the registry. The initial strategy I have used was to, once I saw an element I did not like, search for a relevant registry script to remove it. This is a tedious process and I do not recommend it to anyone, but if you choose to, you can use the MajorGeeks Tweaker (https://www.majorgeeks.com/files/details/majorgeeks_registry_tweaks.html), to simplify the process. 
  After some consideration I decided to make my own context menu with Nilesoft shell, feel free to take a look at it in (NilesoftShell). Just be aware that some context menus require correct positioning of portable software in the (_MyPrograms/Portable) folder. Carefully examine the files, and find the paths and adjust them if necessary.
  # High contrast theme
  That takes care of most of the glaring software issues. The only windows related thing left is to theme the whole system to dark theme. Unfortunately there is no reliable way to do that, only workarounds. While you could make a fully custom theme, or use a tool like window blinds, those methods are full of bugs and in the end they will make your experience worse and unstable. The simplest way to theme windows is to use the high contrast themes. In a way they are too simple, like who the hell has thought it would be a good idea to use the same color for the border and text of an item... Anyway, it is possible to achieve a somewhat good color balance, you can find my theme (WindowsTheme/MyDark.theme) and move it to the (AppData\Local\Microsoft\Windows\Themes) to check it out. I use it with a night light software (redshift), this is why most of the stuff is yellow. \
  Some programs, like browsers might not adapt well to the high contrast settings, you will have to theme them separately to make them usable again. In my opinion the trouble is worth it to get the black window title bars.
  # Portable Software management
  Last thing I should probably explain is the folder structure and scripts used to manage portable programs. While you could have a folder with .exe installers and run them every time you install windows, or you could make a winget powershell script, you could also just have the programs themselves already packed and ready. Since all data is stored in one folder, configuring them like that allows for easy backups, and for example running directly from an usb stick. That said, there are some downsides, the programs will not register automatically. This is why I wrote scripts for automatic shortcut creation (_FolderShortcuts.ps1 and _Shortcuts.ps1) and Path environment registration (_PathRegistrator.ps1). They are still not enough to fully install the programs, they still require manual FileExtension - ProgramPath registration. I might automate that somewhere in the future.
  # Automatic backups
  I wrote a script to automatically backup the system, using restic, to connected drives on boot. Check out the (_BackupScript.ps1)




